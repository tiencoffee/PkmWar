var Move,Pkd,Pkm,Stat,Type,app,bootState,game,loadState,menuState,pkms,playState,selPkd,modulo=function(e,a){return(+e%(a=+a)+a)%a};Type=null,Stat=null,Move=null,Pkd=null,app=null,game=null,selPkd=null,pkms=[],bootState={preload:function(){return game.load.json("Type","models/Type.json"),game.load.json("Stat","models/Stat.json"),game.load.json("Move","models/Move.json"),game.load.json("Pkd","models/Pkd.json")},create:function(){var e,a;for(e in Type=game.cache.getJSON("Type"),Stat=game.cache.getJSON("Stat"),Move=game.cache.getJSON("Move"),Pkd=game.cache.getJSON("Pkd"))(a=Pkd[e]).moves=a.moves.map(e=>Move[e]);Vue.mixin({created:function(){var e;e=document.createElement("div"),document.body.appendChild(e),this.$mount(e)},destroyed:function(){return this.$el.remove()}}),game.physics.startSystem(Phaser.Physics.ARCADE),game.state.start("load")}},loadState={preload:function(){var e,a,t;for(e in game.load.image("pkdIcon","assets/pkdIcon.png"),Pkd)t=(a=Pkd[e]).largeSprite?64:32,game.load.spritesheet(e,`assets/pkd/${a.no}.png`,t,t,8)},create:function(){game.state.start("menu")}},menuState={create:function(){var e,a,t;(e=game.add.graphics()).beginFill(16007990),e.drawRect(0,0,game.world.centerX,game.height),e.beginFill(38536),e.drawRect(game.world.centerX,0,game.world.centerX,game.height),e.beginFill(13421772),e.drawRect(game.world.centerX-10,0,20,game.height),e.drawCircle(game.world.centerX,game.world.centerY,192),e.beginFill(12303291),e.drawCircle(game.world.centerX,game.world.centerY,160),e.endFill(),e.inputEnabled=!0,e.events.onInputUp.add(function(e,a){var t;t=new Pkm(game,selPkd.name,a.positionUp.x,a.positionUp.y,3,game.math.between(0,1)),pkms.add(t)}),(a=game.add.text(game.world.centerX,24,"Pok√©mon War",{font:"bold 16pt fantasy",fill:"#fff",stroke:"#111",strokeThickness:6})).anchor.set(.5),a.alpha=.2,game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR).onDown.add(function(){t.$el.hidden=!t.$el.hidden}),selPkd=Pkd.bulbasaur,pkms=game.add.group(),t=new Vue({template:"<Menu />",components:["url:components/Menu.vue"]})},update:function(){game.physics.arcade.collide(pkms),pkms.sort("y",Phaser.Group.SORT_ASCENDING)}},playState={create:function(){pkms.callAll("randomWalk")},update:function(){game.physics.arcade.collide(pkms),pkms.sort("y",Phaser.Group.SORT_ASCENDING)}},(game=new Phaser.Game({width:window.innerWidth,height:window.innerHeight,renderer:Phaser.AUTO,antialias:!1,scaleMode:Phaser.ScaleManager.SHOW_ALL})).state.add("boot",bootState,!0),game.state.add("load",loadState),game.state.add("menu",menuState),game.state.add("play",playState),Pkm=function(){class e extends Phaser.Sprite{constructor(e,a,t,o,d,s){var n;super(e,t,o,a),this.team=s,this.pkd=Pkd[a],this.scale.set(3),this.anchor.set(.5,.75),this.smoothed=!1,this.animations.add("walk-0",[0,1],8,!0),this.animations.add("walk-1",[6,7],8,!0),this.animations.add("walk-2",[2,3],8,!0),this.animations.add("walk-3",[4,5],8,!0),this.game.physics.arcade.enableBody(this),n=this.width/this.scale.x/4,this.body.setCircle(n,n,2*n),this.body.collideWorldBounds=!0,this.body.allowGravity=!1,this.body.mass=1+this.pkd.weight/1e3,this.setD(d),this.body.onMoveComplete.add(()=>{this.randomWalk()}),this.body.onWorldBounds=new Phaser.Signal,this.body.onWorldBounds.add(()=>{this.body.stopMovement()}),this.body.onCollide=new Phaser.Signal,this.body.onCollide.add(e=>{this.team===e.team?this.collideAlly(e):this.collideEnemy(e)})}setD(e){var a;null!=e&&(this.d=modulo(e,4),a=this.constructor.dMap[this.d],this.frame=a.frame,this.body.angle=a.angle)}walk(e,a){this.setD(a),this.constructor.dMap[this.d],this.animations.play(`walk-${this.d}`),this.body.moveTo(5*e*100/this.pkd.stats.spe,e)}randomWalk(){this.body.isMoving||this.walk(this.game.math.between(10,300),this.game.math.between(0,3))}collideAlly(e){this.body.stopMovement()}collideEnemy(e){}}return e.dMap=[{frame:0,angle:-Math.PI/2,delta:{x:0,y:-1}},{frame:6,angle:0,delta:{x:1,y:0}},{frame:2,angle:Math.PI/2,delta:{x:0,y:1}},{frame:4,angle:Math.PI,delta:{x:-1,y:0}}],e}.call(this);